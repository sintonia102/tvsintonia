<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>TV App - Sencilla</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background-color: #000; overflow: hidden; }
        #videoPlayer { width: 100%; height: 100%; }
        #debug { position: fixed; bottom: 0; left: 0; background: rgba(0,0,0,0.5); color: white; padding: 10px; font-size: 16px; z-index: 1000; }
    </style>
</head>
<body>
    <video id="videoPlayer"></video>
    <div id="debug">Iniciando...</div>

    <script>
        // Espera a que la ventana esté completamente cargada
        window.onload = function() {
            const video = document.getElementById('videoPlayer');
            const debug = document.getElementById('debug');

            // Lista de canales
            const channels = [
                "https://f24.live.streaming.meta.com/Content/HLS/Live/channel(fra24_en)/index.m3u8", // France 24
                "https://service-stitcher.clusters.pluto.tv/v1/stitch/embed/hls/channel/5d548f95c18c3900096696d5/master.m3u8"  // Pluto TV
            ];
            let currentChannel = 0;

            function log(message) {
                console.log(message);
                debug.textContent = message;
            }

            // Comprobación de la librería HLS
            if (typeof Hls === 'undefined') {
                log("ERROR: La librería Hls no se cargó.");
                return;
            }

            if (!Hls.isSupported()) {
                log("ERROR: HLS no es compatible con este navegador.");
                return;
            }

            log("HLS es compatible. Configurando reproductor.");
            const hls = new Hls();
            hls.attachMedia(video);

            function loadChannel(index) {
                log(`Cargando canal ${index + 1}...`);
                hls.loadSource(channels[index]);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    log("Canal cargado. Intentando reproducir.");
                    video.muted = true; // El mute es crucial para el autoplay
                    video.play().catch(e => {
                        log(`Error de reproducción: ${e.message}`);
                    });
                });
                hls.on(Hls.Events.ERROR, function(event, data) {
                    if (data.fatal) {
                        log(`Error fatal de HLS: ${data.details}`);
                    }
                });
            }

            video.onplaying = function() {
                log(`Reproduciendo Canal ${currentChannel + 1}`);
            };

            // Manejo del control remoto
            document.addEventListener('keydown', function(e) {
                log(`Tecla presionada: ${e.key}`);
                const totalChannels = channels.length;
                if (e.key === 'ArrowUp') {
                    currentChannel = (currentChannel + 1) % totalChannels;
                    loadChannel(currentChannel);
                } else if (e.key === 'ArrowDown') {
                    currentChannel = (currentChannel - 1 + totalChannels) % totalChannels;
                    loadChannel(currentChannel);
                }
            });

            // Carga inicial
            loadChannel(currentChannel);
        };
    </script>
</body>
</html>
